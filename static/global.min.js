!function(a){Drupal.mwt_base=Drupal.mwt_base||{},Drupal.mwt_base.elIsMoreThanHalfWay=function(b,c,d){var e;return d?(propertyToTest=b.offsetLeft,e=c.offsetWidth):(propertyToTest=a(b).offset().top-a(window).scrollTop(),e=window.innerHeight),0+(propertyToTest>e/2)},Drupal.behaviors.topNav={attach:function(b,c){var d,e=5,f=["main-nav"],g=['<div class="'+f+' main-nav--header show">'],h=["</div>"],i=function(){var b=["<nav><ul>"];return a(".site-footer .main-nav li").each(function(c){e>c&&("current"==a(this).attr("class")?b.push(['<li class="current">',a(this).html(),"</li>"].join("")):b.push(["<li>",a(this).html(),"</li>"].join("")))}),b.push("</ul></nav>"),b};d=g,d=d.concat(i()),d=d.concat(h),0===a(".site-header ."+f).length&&a("header[role=banner] .nav-link").after(d.join("")),0===a(".site-footer .search-form").length&&a(".search-form").clone().prependTo(".site-footer .wrap")}},Drupal.behaviors.messageCloseButton={attach:function(b,c){var d=a(".sitewide-alert__button"),e=a(".sitewide-alert");/sitewideMessageSeen/.test(document.cookie)||e.show(),d.length&&d.on("click",function(){var a=new Date(Date.now());a.setDate(a.getDate()+1),document.cookie="sitewideMessageSeen=1; expires="+a.toUTCString(),e.remove()})}},Drupal.behaviors.loadFullImgs={attach:function(b,c){var d=function(){a("[data-img]").each(function(){!function(b){var c=b.data("img")?b.data("img"):b.attr("href");if(c){var d=new Image;a(d).bind("load",function(){"IMG"==b.prop("nodeName")?b.attr("src",c):b.replaceWith('<img src="'+c+'"/>')}),d.src=c}}(a(this))})};a(window).width()>480&&d()}},Drupal.behaviors.storyTitles={attach:function(b,c){var d,e=a(".stories-list .story-title--image"),f=a(".stories-list .story-title--image"),g=a(".stories-list--home .story-title--image"),h=a(".story .story-title--image");if(f.length>0)d=function(){f.each(function(){var b=a(this).parent(),c=a("img",this),d=a(this).data("small"),e=a(this).data("alt");a(document).width()<720?(d=a(this).data("large"),b.addClass("story-title--large")):b.removeClass("story-title--large"),0===c.length&&(a(this).html('<img alt="'+e+'">'),c=a("img",this),c.bind("load",function(b){a(b.target).parent().parent().addClass("img-loaded")})),c.attr("src")!==d&&c.attr("src",d)})};else if(g.length>0)d=function(){g.each(function(){var b=a(this).parent(),c=a("img",this),d=a(this).data("small"),e=a(this).data("alt");b.width()>300?(d=a(this).data("large"),b.addClass("story-title--large")):b.removeClass("story-title--large"),0===c.length&&(a(this).html('<img alt="'+e+'">'),c=a("img",this),c.bind("load",function(b){a(b.target).parent().parent().addClass("img-loaded")})),c.attr("src")!==d&&c.attr("src",d)})};else if(h.length>0)var d=function(){h.each(function(){var b=a(this).parent(),c=a("img",this),d=a(this).data("small"),e=a(this).data("alt");b.width()>300?(d=a(this).data("large"),b.addClass("story-title--large")):b.removeClass("story-title--large"),0===c.length&&(a(this).html('<img alt="'+e+'">'),c=a("img",this),c.bind("load",function(b){a(b.target).parent().parent().addClass("img-loaded")})),c.attr("src")!==d&&c.attr("src",d)})};else d=function(){e.each(function(){var b=(a(this).parent(),a("img",this)),c=a(this).data("small"),d=a(this).data("alt");a(document).width()>559?(0===b.length&&(a(this).html('<img alt="'+d+'">'),b=a("img",this),b.bind("load",function(b){a(b.target).parent().parent().addClass("img-loaded")}),b.attr("src")!==c&&b.attr("src",c)),b.show()):b.length>0&&a(document).width()<559&&b.hide()})};d(),a(window).bind("resize",function(){d()})}},Drupal.behaviors.createUrl={attach:function(){var b=a(".series-list-item__article");b.each(function(){var b=a(this),c=b.find("a"),d=c.attr("href");1===c.length&&(b.addClass("is--clickable"),c.on("click",function(a){a.stopPropagation()}),b.on("click",function(){window.location.href=d}))})}},Drupal.behaviors.glossaryLinksPopups={attach:function(b,c){var d=function(a){var b=a.replace(/[ \W]/g,"");return b.length>100&&(b=b.substring(0,100)),b},e=function(b){b.bind("click",function(c){a(c.target).addClass("open");var e,f,g,h,i,j,k,l,m,n=[],o=c.target,p=function(){a("#"+f).removeAttr("style"),a(document).unbind("click.popup",p),a(c.target).removeClass("open")};o.className.indexOf("glossary-link")>-1&&(c.preventDefault(),e=o.innerHTML,f=d(e),g=a("#"+f).eq(0),i=o.offsetTop+o.offsetHeight+5,g.css("top",i),k=Drupal.mwt_base.elIsMoreThanHalfWay(o,b.get(0),!1),l=0+Modernizr.mq("only screen and (min-width: 69.5em)"),m={x:["right","left"],y:["top","bottom"]},n=["nip-",m.y[k],m.x[j]],g.addClass(n),j=Drupal.mwt_base.elIsMoreThanHalfWay(o,b.get(0),!0),j?(g.removeClass("nip-left nip-right"),g.addClass("nip-right"),h=o.offsetLeft-g.get(0).offsetWidth+19):(g.removeClass("nip-left nip-right"),g.addClass("nip-left"),h=o.offsetLeft),k?(g.removeClass("nip-top nip-bottom"),g.addClass("nip-bottom"),i=a(o).position().top-g.get(0).offsetHeight-20):(g.removeClass("nip-top nip-bottom"),g.addClass("nip-top"),i=a(o).offset().top-a(o).get(0).offsetHeight-60),g.css("left",h),g.css("top",i),g.css("z-index","20")),setTimeout(function(){a(document).bind("click.popup",p)},15),a("#"+f).bind("click",function(a){a.stopPropagation(),"A"!==a.target.nodeName&&a.preventDefault()})})},f=function(){var b=a(".site-main").eq(0);e(b)};f()}},Drupal.behaviors.ajaxInclude={attach:function(b,c){a("[data-replace], [data-append], [data-before]").ajaxInclude(),a("[data-after]").each(function(b){if(a(this).data("ajax-bound")){var c,d=a(this).data("method");c="after"!==d?a(this).prev():a(this).next()}else a(this).ajaxInclude()})}},Drupal.behaviors.infinitescroll={attach:function(b,c){var d=a(".pager");if(!(d.length<1)){d.hide();var e=Drupal.settings.basePath+"sites/all/themes/mwt_base/images/loading.gif";0===d.prev(".button-load-more").length&&d.before('<div id="load-image" style="display: none"><img src="'+e+'" /></div><a class="button button-load-more" href="#">More</a>');var f=a(".button-load-more");f.on("click",function(b){b.preventDefault(),a("#load-image").show();var c=a(".pager-item").first(),d=c.children().attr("href");a.ajax({type:"GET",url:d,success:function(b){a("#load-image").hide();var d=a(b);a(".stories-list, .search-results").append(d.find(".story-list-item, .search-item")),c.removeClass("pager-item");var e=a(".pager-item");e.length<1&&f.hide()}})})}}},Drupal.behaviors.autoSubmitFilters={attach:function(b,c){a(".form-checkbox").change(function(){a("#mosaic-search-filters").submit()})}},Drupal.behaviors.createImageSliders={attach:function(b,c){var d=navigator.userAgent.indexOf("Opera Mini")>-1;if(!(a(".royalSlider").length<1))if(d){var e=a(".rsImg");e.each(function(){var b=a(this),c=b.find("noscript");if(c.length>0){var d=b.attr("href");imgEl=a('<img src="'+d+'" alt="">'),b.before(imgEl),b.remove()}})}else{var f=a(".royalSlider").royalSlider({addActiveClass:!0,arrowsNav:!0,controlNavigation:"none",autoScaleSlider:!0,autoScaleSliderWidth:650,autoScaleSliderHeight:464,loop:!0,fadeinLoadedSlide:!1,globalCaption:!0,keyboardNavEnabled:!0,globalCaptionInside:!1,slidesSpacing:0,numImagesToPreload:2,fullscreen:{enabled:!0,nativeFS:!0}}).data("royalSlider");a(document).keydown(function(b){var b=b||window.event,c=a(".rsFullscreen .rsGCaption");"38"==b.keyCode?c.hasClass("caption-visible")||a(".rsFullscreen .rsGCaption").addClass("caption-visible"):"40"==b.keyCode&&c.hasClass("caption-visible")&&a(".rsFullscreen .rsGCaption").removeClass("caption-visible")}),a(window).on("resize",function(){f.goTo(f.currSlideId)})}}},Drupal.behaviors.trackNewsletterSignups={attach:function(b,c){a("#footer .form-submit").on("click",function(){ga("send","event","Email-signup","click","Email-signup - "+document.URL)})}},Drupal.behaviors.extras={attach:function(b,c){a(".inline-extra--toggle").each(function(){var b=this.getAttribute("data-extra-content"),c="#"+b,d=a(c).html();a(this).siblings("aside").length>0||(void 0!=d&&a(this).parent().append('<aside class="inline-extra--item">'+d+"</aside>"),a(c).hide(),a(this).hide())})}},Drupal.behaviors.addStoryClass={attach:function(b,c){a("#story-header").length>0&&a(".media-image_portrait").each(function(){var b=a(this).next().hasClass("media-image_portrait");b&&a(this).add(a(this).next()).wrapAll('<div class="media-image-wrapper clearfix"></div>')})}},Drupal.behaviors.lazyloadLowResFix={attach:function(b,c){if(a(".series-list").length>0){var d=function(){a(".series-list .series-list-item__background__image").each(function(){var b=a(this).data("img-small"),c=a(this).data("img-large");a(window).width()<750?a(this).attr("src",b):a(this).attr("src",c)})};d(),a(window).resize(function(){d()})}}},Drupal.behaviors.storyOptions={attach:function(b,c){var d=a(".js-story-toggle__content");d.hide(),a(".js-story-toggle").each(function(b){var c=a(this).text();a(this).next(".js-story-toggle__content").attr({id:"collapsible-"+b,"aria-hidden":"true"}),a(this).replaceWith('<button class="story-toggle js-story-toggle" aria-expanded="false" aria-controls="collapsible-'+b+'">'+c+"</button>")}),a(".js-story-toggle").on("click",function(b){b.preventDefault();var c=a(this).next(".js-story-toggle__content");a(this).hasClass("story-toggle--open")?(d.hide(),a(this).removeClass("story-toggle--open").attr("aria-expanded","false"),c.attr("aria-hidden","true")):(d.hide(),a(".js-story-toggle__content").attr("aria-hidden","true"),a(".story-toggle--open").removeClass("story-toggle--open").attr("aria-expanded","false"),c.show(),a(this).addClass("story-toggle--open").attr("aria-expanded","true"),c.attr("aria-hidden","false"))}),a("body").on("click",function(b){0===a(b.target).closest(".story-options__item").length&&(d.hide(),a(".js-story-toggle__content").attr("aria-hidden","true"),a(".story-toggle--open").removeClass("story-toggle--open").attr("aria-expanded","false"))})}}}(jQuery);